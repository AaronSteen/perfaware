; ========================================================================
; 8086 test set — 9 decode groups (10 instructions each)
; Source: listing_0042_completionist_decode.asm
; Dialect: NASM
; ========================================================================

bits 16

; ------------------------------------------------------------------------
; Group 1 — r/m <-> reg (ModRM path; includes LEA/LDS/LES; A0–A3 handled in G1)
; ------------------------------------------------------------------------

mov si, bx
; hex: 89 DE
; bin: [1000 1001] [1101 1110]

mov dh, al
; hex: 88 C6
; bin: [1000 1000] [1100 0110]

mov al, [bx + si]
; hex: 8A 00
; bin: [1000 1010] [0000 0000]

mov bx, [bp + di]
; hex: 8B 1B
; bin: [1000 1011] [0001 1011]

mov dx, [bp]
; hex: 8B 56 00
; bin: [1000 1011] [0101 0110] [0000 0000]

mov ah, [bx + si + 4]
; hex: 8A 60 04
; bin: [1000 1010] [0110 0000] [0000 0100]

mov [bx + di], cx
; hex: 89 09
; bin: [1000 1001] [0000 1001]

mov [bp + si], cl
; hex: 88 0A
; bin: [1000 1000] [0000 1010]

xchg ax, [bp - 1000]
; hex: 87 86 18 FC
; bin: [1000 0111] [1000 0110] [0001 1000] [1111 1100]

xchg [bx + 50], bp
; hex: 87 6F 32
; bin: [1000 0111] [0110 1111] [0011 0010]

; ------------------------------------------------------------------------
; Group 2 — imm -> r/m (80–83 ALU imm to r/m; C6/C7 MOV imm->r/m)
; ------------------------------------------------------------------------

mov [bp + di], byte 7
; hex: C6 03 07
; bin: [1100 0110] [0000 0011] [0000 0111]

mov [di + 901], word 347
; hex: C7 85 85 03 5B 01
; bin: [1100 0111] [1000 0101] [1000 0101] [0000 0011] [0101 1011] [0000 0001]

add si, 5
; hex: 83 C6 05
; bin: [1000 0011] [1100 0110] [0000 0101]

add ah, 30
; hex: 80 C4 1E
; bin: [1000 0000] [1100 0100] [0001 1110]

adc si, 5
; hex: 83 D6 05
; bin: [1000 0011] [1101 0110] [0000 0101]

adc ah, 30
; hex: 80 D4 1E
; bin: [1000 0000] [1101 0100] [0001 1110]

sub si, 5
; hex: 83 EE 05
; bin: [1000 0011] [1110 1110] [0000 0101]

sub ah, 30
; hex: 80 EC 1E
; bin: [1000 0000] [1110 1100] [0001 1110]

sbb si, 5
; hex: 83 DE 05
; bin: [1000 0011] [1101 1110] [0000 0101]

sbb ah, 30
; hex: 80 DC 1E
; bin: [1000 0000] [1101 1100] [0001 1110]

; ------------------------------------------------------------------------
; Group 3 — unary r/m (8F, F6/F7, FE/FF families)
; ------------------------------------------------------------------------

inc byte [bp + 1002]
; hex: FE 86 EA 03
; bin: [1111 1110] [1000 0110] [1110 1010] [0000 0011]

inc word [bx + 39]
; hex: FF 47 27
; bin: [1111 1111] [0100 0111] [0010 0111]

dec byte [bx + si + 5]
; hex: FE 48 05
; bin: [1111 1110] [0100 1000] [0000 0101]

dec word [bp + di - 10044]
; hex: FF 4B 14 D9
; bin: [1111 1111] [0100 1011] [0001 0100] [1101 1001]

neg byte [bp + 1002]
; hex: F6 9E EA 03
; bin: [1111 0110] [1001 1110] [1110 1010] [0000 0011]

neg word [bx + 39]
; hex: F7 5F 27
; bin: [1111 0111] [0101 1111] [0010 0111]

not word [bp]
; hex: F7 56 00
; bin: [1111 0111] [0101 0110] [0000 0000]

not byte [bp + 9905]
; hex: F6 96 B1 26
; bin: [1111 0110] [1001 0110] [1011 0001] [0010 0110]

mul byte [bx + di + 500]
; hex: F6 A1 F4 01
; bin: [1111 0110] [1010 0001] [1111 0100] [0000 0001]

imul word [9483]
; hex: F7 2E 0B 25
; bin: [1111 0111] [0010 1110] [0000 1011] [0010 0101]

; ------------------------------------------------------------------------
; Group 4 — accumulator immediates (AL/AX)
; ------------------------------------------------------------------------

add ax, 1000
; hex: 05 E8 03
; bin: [0000 0101] [1110 1000] [0000 0011]

add al, 9
; hex: 04 09
; bin: [0000 0100] [0000 1001]

adc ax, 1000
; hex: 15 E8 03
; bin: [0001 0101] [1110 1000] [0000 0011]

adc al, 9
; hex: 14 09
; bin: [0001 0100] [0000 1001]

sub ax, 1000
; hex: 2D E8 03
; bin: [0010 1101] [1110 1000] [0000 0011]

sub al, 9
; hex: 2C 09
; bin: [0010 1100] [0000 1001]

sbb ax, 1000
; hex: 1D E8 03
; bin: [0001 1101] [1110 1000] [0000 0011]

sbb al, 9
; hex: 1C 09
; bin: [0001 1100] [0000 1001]

cmp ax, 23909
; hex: 3D 65 5D
; bin: [0011 1101] [0110 0101] [0101 1101]

and al, 93
; hex: 24 5D
; bin: [0010 0100] [0101 1101]

; ------------------------------------------------------------------------
; Group 5 — reg encoded in opcode, no trailing data
; (INC/DEC r16, PUSH/POP r16, XCHG AX,r16, PUSH/POP Sreg)
; ------------------------------------------------------------------------

push cx
; hex: 51
; bin: [0101 0001]

push ax
; hex: 50
; bin: [0101 0000]

push dx
; hex: 52
; bin: [0101 0010]

push cs
; hex: 0E
; bin: [0000 1110]

pop sp
; hex: 5C
; bin: [0101 1100]

pop di
; hex: 5F
; bin: [0101 1111]

pop si
; hex: 5E
; bin: [0101 1110]

pop ds
; hex: 1F
; bin: [0001 1111]

xchg ax, dx
; hex: 92
; bin: [1001 0010]

xchg ax, si
; hex: 96
; bin: [1001 0110]

; ------------------------------------------------------------------------
; Group 6 — reg encoded in opcode + immediate (B0–BF MOV r,imm)
; ------------------------------------------------------------------------

mov cl, 12
; hex: B1 0C
; bin: [1011 0001] [0000 1100]

mov ch, -12
; hex: B5 F4
; bin: [1011 0101] [1111 0100]

mov cx, 12
; hex: B9 0C 00
; bin: [1011 1001] [0000 1100] [0000 0000]

mov cx, -12
; hex: B9 F4 FF
; bin: [1011 1001] [1111 0100] [1111 1111]

mov dx, 3948
; hex: BA 6C 0F
; bin: [1011 1010] [0110 1100] [0000 1111]

mov dx, -3948
; hex: BA 94 F0
; bin: [1011 1010] [1001 0100] [1111 0000]

mov al, 93
; hex: B0 5D
; bin: [1011 0000] [0101 1101]

mov ah, 30
; hex: B4 1E
; bin: [1011 0100] [0001 1110]

mov si, 5
; hex: BE 05 00
; bin: [1011 1110] [0000 0101] [0000 0000]

mov ax, 1000
; hex: B8 E8 03
; bin: [1011 1000] [1110 1000] [0000 0011]

; ------------------------------------------------------------------------
; Group 7 — single-byte, no ModRM (misc, prefixes, strings)
; (REP/REPNZ + string ops here; LOCK-prefixed r/m ops counted with their core groups)
; ------------------------------------------------------------------------

xlat
; hex: D7
; bin: [1101 0111]

lahf
; hex: 9F
; bin: [1001 1111]

sahf
; hex: 9E
; bin: [1001 1110]

pushf
; hex: 9C
; bin: [1001 1100]

popf
; hex: 9D
; bin: [1001 1101]

aaa
; hex: 37
; bin: [0011 0111]

daa
; hex: 27
; bin: [0010 0111]

aas
; hex: 3F
; bin: [0011 1111]

das
; hex: 2F
; bin: [0010 1111]

nop
; hex: 90
; bin: [1001 0000]

; ------------------------------------------------------------------------
; Group 8 — shifts/rotates with ModRM (D0–D3 by 1 or by CL)
; ------------------------------------------------------------------------

shl ah, 1
; hex: D0 E4
; bin: [1101 0000] [1110 0100]

shr ax, 1
; hex: D1 E8
; bin: [1101 0001] [1110 1000]

sar bx, 1
; hex: D1 FB
; bin: [1101 0001] [1111 1011]

rol cx, 1
; hex: D1 C1
; bin: [1101 0001] [1100 0001]

ror dh, 1
; hex: D0 CA
; bin: [1101 0000] [1100 1010]

rcl sp, 1
; hex: D1 D4
; bin: [1101 0001] [1101 0100]

rcr bp, 1
; hex: D1 DD
; bin: [1101 0001] [1101 1101]

shl ah, cl
; hex: D2 E4
; bin: [1101 0010] [1110 0100]

shr ax, cl
; hex: D3 E8
; bin: [1101 0011] [1110 1000]

sar bx, cl
; hex: D3 FB
; bin: [1101 0011] [1111 1011]

; ------------------------------------------------------------------------
; Group 9 — control transfer & I/O (Jcc/loop/jcxz, call/jmp/ret/int, in/out)
; ------------------------------------------------------------------------

in al, 200
; hex: E4 C8
; bin: [1110 0100] [1100 1000]

in al, dx
; hex: EC
; bin: [1110 1100]

in ax, dx
; hex: ED
; bin: [1110 1101]

out 44, ax
; hex: E7 2C
; bin: [1110 0111] [0010 1100]

out dx, al
; hex: EE
; bin: [1110 1110]

call [39201]
; hex: FF 16 71 99
; bin: [1111 1111] [0001 0110] [0111 0001] [1001 1001]

jmp [4395]
; hex: FF 26 2B 11
; bin: [1111 1111] [0010 0110] [0010 1011] [0001 0001]

ret
; hex: C3
; bin: [1100 0011]

je label
; hex: 74 00
; bin: [0111 0100] [0000 0000]

loop label
; hex: E2 FE
; bin: [1110 0010] [1111 1110]

label:
